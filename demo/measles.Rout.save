
R version 4.3.0 (2023-04-21) -- "Already Tomorrow"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ################################################################################
> ### Demo of hhh4ZI() modelling of measles in Germany - data("measles")
> ### based on
> ###
> ### Lu and Meyer (2023): A zero-inflated endemic-epidemic model
> ### with an application to measles time series in Germany.
> ###
> ### RUNNING THE WHOLE SCRIPT TAKES about 1 hour!
> ################################################################################
> 
> library(hhh4ZI)
Loading required package: surveillance
Loading required package: sp
Loading required package: xtable
This is surveillance 1.21.0; see ‘package?surveillance’ or
https://surveillance.R-Forge.R-project.org/ for an overview.

Attaching package: ‘hhh4ZI’

The following object is masked from ‘package:surveillance’:

    oneStepAhead

> options(digits = 5)
> 
> # for reproducibility, as ri() parameters are initialized randomly
> RNGversion("3.6.3")
> set.seed(10052021)
> 
> ptm <- proc.time()
> 
> 
> ##################
> # Data preparation
> ##################
> 
> # compute adjusted proportion of vaccinated school starters by year and state
> # using the same assumptions as in Herzog et al. (2011)
> PassRate <- VacPass/TotalKids
> Dosis1Rate <- PassRate * Dosis1/100 + (1 - PassRate) * 0.5 * Dosis1/100
> 
> # Impute two missing values in Hamburg via LOCF
> Dosis1Rate[c("2017", "2018"), "Hamburg"] <- Dosis1Rate["2016", "Hamburg"]
> stopifnot(!anyNA(Dosis1Rate))
> 
> # setup covariate matrix for dim(measles), i.e., replicate each row 26 times
> Dosis1Rate <- as.matrix(Dosis1Rate)
> Coverage <- Dosis1Rate[rep(1 : nrow(Dosis1Rate), each = measles@freq),]
> rm(list = c("PassRate", "Dosis1Rate"))
> 
> # covariate data for the model: time index and log(proportion unvaccinated)
> covarlist <- list(t = epoch(measles),
+                   logVac0 = log(1 - Coverage))
> Vac0 <-  (1 - 0.92 * Coverage)
> # higher-than-default niter is needed for rolling forecasts
> control.optimizer <-  list(stop = list(tol = 1e-5, niter = 200),
+                            regression = list(method = "nlminb"),
+                            variance = list(method = "Nelder-Mead"))
> 
> ##################################################
> # Fit the models
> ##################################################
> 
> #############################
> ####### Model P0 ############
> #############################
> 
> # endemic component: Intercept + sine/cosine terms
> f.end <- addSeason2formula(f = ~ 1, S = 1, period = 26)
> # autoregressive component: Intercept + proportion unvaccinated
> f.ar <- ~ 1 + logVac0
> 
> model.P0 <- list(ar = list(f = f.ar),
+                  end = list(f = f.end, offset = population(measles)),
+                  data = covarlist,
+                  family = "Poisson",
+                  optimizer = control.optimizer)
> # fit the model
> result.P0 <- hhh4(measles, model.P0)
> summary(result.P0, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4(stsObj = measles, control = model.P0)

Coefficients:
                      Estimate  Std. Error
ar.1                   0.7130    0.1191   
ar.logVac0             0.3633    0.0475   
end.1                  1.9243    0.0257   
end.A(2 * pi * t/26)   0.5480    0.0360   
end.s(2 * pi * t/26)  -0.4619    0.0481   

Epidemic dominant eigenvalue:  0.86 -- 1.00 

Log-likelihood:   -9299.5 
AIC:              18609 
BIC:              18642 

Number of units:        16 
Number of time points:  363 

> 
> 
> #############################
> ####### Model NB1 ############
> #############################
> 
> f.end <- addSeason2formula(f = ~ 1, S = 2, period = 52)
> f.ar <- addSeason2formula(f = ~ 1, S = 2, period = 52)
> 
> model.NB1 <- list(ar = list(f = f.ar, offset =  Vac0 ),
+                   end = list(f = f.end, offset = population(measles) * Vac0),
+                   data = covarlist,
+                   family = "NegBinM",
+                   optimizer = control.optimizer)
> 
> result.NB1 <- hhh4(measles, model.NB1)
> summary(result.NB1, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4(stsObj = measles, control = model.NB1)

Coefficients:
                                        Estimate  Std. Error
ar.1                                     1.3847    0.0391   
ar.A(2 * pi * t/52)                      0.1105    0.0558   
ar.s(2 * pi * t/52)                      1.1643    0.0403   
ar.A(4 * pi * t/52)                      0.4276    0.0524   
ar.s(4 * pi * t/52)                     -0.0578    0.1166   
end.1                                    3.9820    0.0348   
end.A(2 * pi * t/52)                     0.1339    0.0469   
end.s(2 * pi * t/52)                     1.0288    0.0468   
end.A(4 * pi * t/52)                     0.4439    0.0483   
end.s(4 * pi * t/52)                    -0.8105    0.0509   
overdisp.Schleswig-Holstein              1.2455    0.2372   
overdisp.Hamburg                         0.8396    0.2087   
overdisp.Lower Saxony                    1.1551    0.1823   
overdisp.Bremen                          4.7319    1.7062   
overdisp.North Rhine-Westphalia          0.6467    0.0836   
overdisp.Hesse                           0.8631    0.1503   
overdisp.Rhineland-Palatinate            0.7807    0.1747   
overdisp.Baden-Wuerttemberg              0.8421    0.1211   
overdisp.Bavaria                         0.4873    0.0583   
overdisp.Saarland                        3.4746    1.9996   
overdisp.Berlin                          0.7992    0.1273   
overdisp.Brandenburg                     1.6420    0.3879   
overdisp.Mecklenburg-Western Pomerania   4.5444    2.6118   
overdisp.Saxony                          1.9642    0.4527   
overdisp.Saxony-Anhalt                   3.2424    0.8830   
overdisp.Thuringia                      10.2747    2.4315   

Epidemic dominant eigenvalue:  0.41 -- 1.42 

Log-likelihood:   -7059 
AIC:              14170 
BIC:              14343 

Number of units:        16 
Number of time points:  363 

> 
> #############################
> ####### Model NB2 ############
> #############################
> 
> f.end <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "none"),
+                            S = 2, period = 52)
> f.ar <- addSeason2formula(f = ~ -1 + ri(type = "iid", corr = "none"),
+                           S = 2, period = 52)
> 
> model.NB2 <- list(ar = list(f = f.ar, offset =  Vac0),
+                   end = list(f = f.end, offset = population(measles) * Vac0),
+                   data = covarlist,
+                   family = "NegBinM",
+                   optimizer = control.optimizer)
> 
> result.NB2 <- hhh4(measles, model.NB2)
> summary(result.NB2, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4(stsObj = measles, control = model.NB2)

Random effects:
            Var    Corr 
ar.ri(iid)  0.0472      
end.ri(iid) 0.2261 0    

Fixed effects:
                                        Estimate  Std. Error
ar.A(2 * pi * t/52)                      0.1316    0.0551   
ar.s(2 * pi * t/52)                      1.3487    0.0350   
ar.A(4 * pi * t/52)                      0.4400    0.0520   
ar.s(4 * pi * t/52)                     -0.0349    0.1133   
ar.ri(iid)                               1.3078    0.0748   
end.A(2 * pi * t/52)                     0.1325    0.0457   
end.s(2 * pi * t/52)                     0.9894    0.0473   
end.A(4 * pi * t/52)                     0.4444    0.0475   
end.s(4 * pi * t/52)                    -0.8270    0.0488   
end.ri(iid)                              3.9418    0.1250   
overdisp.Schleswig-Holstein              1.0865    0.2131   
overdisp.Hamburg                         0.7719    0.1925   
overdisp.Lower Saxony                    1.0874    0.1766   
overdisp.Bremen                          4.2469    1.6094   
overdisp.North Rhine-Westphalia          0.5958    0.0784   
overdisp.Hesse                           0.8413    0.1480   
overdisp.Rhineland-Palatinate            0.6836    0.1629   
overdisp.Baden-Wuerttemberg              0.7745    0.1126   
overdisp.Bavaria                         0.4742    0.0571   
overdisp.Saarland                        2.6987    1.5414   
overdisp.Berlin                          0.7051    0.1130   
overdisp.Brandenburg                     1.6142    0.3862   
overdisp.Mecklenburg-Western Pomerania   1.5821    0.9385   
overdisp.Saxony                          1.6834    0.3881   
overdisp.Saxony-Anhalt                   3.1603    0.8677   
overdisp.Thuringia                      10.3010    2.4388   

Epidemic dominant eigenvalue:  0.40 -- 1.52 

Penalized log-likelihood:  -6966.9 
Marginal log-likelihood:   -92.6 

Number of units:        16 
Number of time points:  363 

> 
> #############################
> ####### Model NB3############
> #############################
> 
> f.end <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "all"),
+                            S = 2, period = 52)
> f.ar <- addSeason2formula(f = ~ -1 + ri(type = "iid", corr = "all"),
+                           S = 2, period = 52)
> 
> model.NB3 <- list(ar = list(f = f.ar, offset =  Vac0 ),
+                   end = list(f = f.end, offset = population(measles) * Vac0 ),
+                   data = covarlist,
+                   family = "NegBinM",
+                   optimizer = control.optimizer)
> 
> result.NB3 <- hhh4(measles, model.NB3)
> summary(result.NB3, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4(stsObj = measles, control = model.NB3)

Random effects:
            Var   Corr   
ar.ri(iid)  0.053        
end.ri(iid) 0.229 -0.504 

Fixed effects:
                                        Estimate  Std. Error
ar.A(2 * pi * t/52)                      0.1314    0.0550   
ar.s(2 * pi * t/52)                      1.3406    0.0352   
ar.A(4 * pi * t/52)                      0.4391    0.0519   
ar.s(4 * pi * t/52)                     -0.0324    0.1136   
ar.ri(iid)                               1.3245    0.0765   
end.A(2 * pi * t/52)                     0.1311    0.0457   
end.s(2 * pi * t/52)                     0.9947    0.0471   
end.A(4 * pi * t/52)                     0.4443    0.0475   
end.s(4 * pi * t/52)                    -0.8266    0.0489   
end.ri(iid)                              3.9416    0.1256   
overdisp.Schleswig-Holstein              1.0843    0.2125   
overdisp.Hamburg                         0.7745    0.1929   
overdisp.Lower Saxony                    1.0900    0.1770   
overdisp.Bremen                          4.1855    1.5922   
overdisp.North Rhine-Westphalia          0.5951    0.0783   
overdisp.Hesse                           0.8412    0.1480   
overdisp.Rhineland-Palatinate            0.6833    0.1628   
overdisp.Baden-Wuerttemberg              0.7739    0.1126   
overdisp.Bavaria                         0.4739    0.0571   
overdisp.Saarland                        2.6882    1.5399   
overdisp.Berlin                          0.7083    0.1134   
overdisp.Brandenburg                     1.6180    0.3868   
overdisp.Mecklenburg-Western Pomerania   1.6533    0.9628   
overdisp.Saxony                          1.6731    0.3855   
overdisp.Saxony-Anhalt                   3.1509    0.8658   
overdisp.Thuringia                      10.2972    2.4385   

Epidemic dominant eigenvalue:  0.40 -- 1.52 

Penalized log-likelihood:  -6966.5 
Marginal log-likelihood:   -91.7 

Number of units:        16 
Number of time points:  363 

> 
> 
> #############################
> ####### Model ZI1 ############
> #############################
> 
> f.end <- addSeason2formula(f = ~ 1, S = 2, period = 52)
> f.ar <- addSeason2formula(f = ~ 1, S = 2, period = 52)
> f.zi <- ~ 1
> 
> model.ZI1 <- list(ar = list(f = f.ar, offset =  Vac0 ),
+                   end = list(f = f.end, offset = population(measles) * Vac0 ),
+                   zi = list(f = f.zi),
+                   data = covarlist,
+                   family = "NegBinM",
+                   optimizer = control.optimizer)
> 
> result.ZI1 <- hhh4ZI(measles, model.ZI1)
> summary(result.ZI1, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4ZI(stsObj = measles, control = model.ZI1)

Coefficients:
                                        Estimate  Std. Error
ar.1                                     1.4031    0.0414   
ar.A(2 * pi * t/52)                      0.1030    0.0570   
ar.s(2 * pi * t/52)                      1.0578    0.0445   
ar.A(4 * pi * t/52)                      0.4201    0.0525   
ar.s(4 * pi * t/52)                      0.0382    0.1226   
end.1                                    4.2267    0.0482   
end.A(2 * pi * t/52)                     0.1153    0.0481   
end.s(2 * pi * t/52)                     1.0456    0.0464   
end.A(4 * pi * t/52)                     0.4142    0.0492   
end.s(4 * pi * t/52)                    -0.7874    0.0537   
zi.1                                    -1.1651    0.1757   
zi.AR(1)                                -0.4942    0.0912   
overdisp.Schleswig-Holstein              0.9045    0.1939   
overdisp.Hamburg                         0.6192    0.1702   
overdisp.Lower Saxony                    0.8442    0.1513   
overdisp.Bremen                          3.3509    1.3245   
overdisp.North Rhine-Westphalia          0.5205    0.0734   
overdisp.Hesse                           0.6526    0.1254   
overdisp.Rhineland-Palatinate            0.5434    0.1430   
overdisp.Baden-Wuerttemberg              0.6288    0.1020   
overdisp.Bavaria                         0.4119    0.0518   
overdisp.Saarland                        2.6136    1.5770   
overdisp.Berlin                          0.6393    0.1074   
overdisp.Brandenburg                     1.3070    0.3214   
overdisp.Mecklenburg-Western Pomerania   3.3039    1.9799   
overdisp.Saxony                          1.5260    0.3675   
overdisp.Saxony-Anhalt                   2.4212    0.7026   
overdisp.Thuringia                       8.0266    1.9327   

Epidemic dominant eigenvalue:  0.34 -- 1.28 

Log-likelihood:   -7037.4 
AIC:              14131 
BIC:              14318 

Number of units:        16 
Number of time points:  363 

> 
> #############################
> ####### Model ZI2 ############
> #############################
> f.end <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "none"),
+                            S = 2, period = 52)
> f.ar <- addSeason2formula(f = ~-1  +  ri(type = "iid", corr = "none"),
+                           S = 2, period = 52)
> f.zi <- ~-1  +  ri(type = "iid", corr = "none")
> 
> model.ZI2 <- list(ar = list(f = f.ar, offset =  Vac0 ),
+                   end = list(f = f.end, offset = population(measles) * Vac0 ),
+                   zi = list(f = f.zi),
+                   data = covarlist,
+                   family = "NegBinM",
+                   optimizer = control.optimizer)
> 
> result.ZI2 <- hhh4ZI(measles, model.ZI2)
> summary(result.ZI2, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4ZI(stsObj = measles, control = model.ZI2)

Random effects:
            Var    Corr   
ar.ri(iid)  0.0593        
end.ri(iid) 0.3946 0      
zi.ri(iid)  1.5605 0    0 

Fixed effects:
                                        Estimate  Std. Error
ar.A(2 * pi * t/52)                      0.1275    0.0565   
ar.s(2 * pi * t/52)                      1.2884    0.0374   
ar.A(4 * pi * t/52)                      0.4367    0.0525   
ar.s(4 * pi * t/52)                      0.0714    0.1183   
ar.ri(iid)                               1.3389    0.0827   
end.A(2 * pi * t/52)                     0.1287    0.0477   
end.s(2 * pi * t/52)                     1.0114    0.0477   
end.A(4 * pi * t/52)                     0.4258    0.0494   
end.s(4 * pi * t/52)                    -0.8096    0.0519   
end.ri(iid)                              4.5543    0.1733   
zi.AR(1)                                -0.7336    0.1177   
zi.ri(iid)                              -0.4287    0.3522   
overdisp.Schleswig-Holstein              0.8310    0.2276   
overdisp.Hamburg                         0.4553    0.1682   
overdisp.Lower Saxony                    0.8795    0.1850   
overdisp.Bremen                          2.8436    1.5946   
overdisp.North Rhine-Westphalia          0.5324    0.0768   
overdisp.Hesse                           0.5887    0.1344   
overdisp.Rhineland-Palatinate            0.5736    0.1615   
overdisp.Baden-Wuerttemberg              0.6184    0.1097   
overdisp.Bavaria                         0.4460    0.0565   
overdisp.Saarland                        0.6576    0.6082   
overdisp.Berlin                          0.4892    0.0973   
overdisp.Brandenburg                     0.6419    0.2168   
overdisp.Mecklenburg-Western Pomerania   0.9320    0.6489   
overdisp.Saxony                          0.8766    0.2581   
overdisp.Saxony-Anhalt                   0.5387    0.3216   
overdisp.Thuringia                       2.4485    0.8927   

Epidemic dominant eigenvalue:  0.37 -- 1.51 

Penalized log-likelihood:  -6914.3 
Marginal log-likelihood:   -118.7 

Number of units:        16 
Number of time points:  363 

> 
> #############################
> ####### Model ZI3 ############
> #############################
> 
> f.end <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "all") ,
+                            S = 2, period = 52)
> f.ar <- addSeason2formula(f = ~-1  +  ri(type = "iid", corr = "all"),
+                           S = 2, period = 52)
> f.zi <- ~-1  +  ri(type = "iid", corr = "all")
> 
> model.ZI3 <- list(ar = list(f = f.ar, offset =  Vac0 ),
+                   end = list(f = f.end, offset = population(measles) * Vac0 ),
+                   zi = list(f = f.zi),
+                   data = covarlist,
+                   family = "NegBinM",
+                   optimizer = control.optimizer)
> 
> result.ZI3 <- hhh4ZI(measles, model.ZI3)
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
> summary(result.ZI3, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4ZI(stsObj = measles, control = model.ZI3)

Random effects:
            Var   Corr        
ar.ri(iid)  0.071             
end.ri(iid) 0.628 0.299       
zi.ri(iid)  3.128 0.618 0.864 

Fixed effects:
                                        Estimate  Std. Error
ar.A(2 * pi * t/52)                      0.1242    0.0563   
ar.s(2 * pi * t/52)                      1.3228    0.0363   
ar.A(4 * pi * t/52)                      0.4404    0.0525   
ar.s(4 * pi * t/52)                      0.0573    0.1169   
ar.ri(iid)                               1.3451    0.0854   
end.A(2 * pi * t/52)                     0.1367    0.0475   
end.s(2 * pi * t/52)                     0.9962    0.0485   
end.A(4 * pi * t/52)                     0.4238    0.0493   
end.s(4 * pi * t/52)                    -0.8214    0.0513   
end.ri(iid)                              4.5475    0.2069   
zi.AR(1)                                -0.8180    0.1294   
zi.ri(iid)                              -0.8194    0.4819   
overdisp.Schleswig-Holstein              0.9105    0.2186   
overdisp.Hamburg                         0.4600    0.1677   
overdisp.Lower Saxony                    1.0088    0.1752   
overdisp.Bremen                          3.3837    1.4502   
overdisp.North Rhine-Westphalia          0.5496    0.0771   
overdisp.Hesse                           0.6467    0.1474   
overdisp.Rhineland-Palatinate            0.6195    0.1571   
overdisp.Baden-Wuerttemberg              0.6981    0.1184   
overdisp.Bavaria                         0.4461    0.0557   
overdisp.Saarland                        0.3067    0.3322   
overdisp.Berlin                          0.4914    0.0960   
overdisp.Brandenburg                     0.6032    0.2008   
overdisp.Mecklenburg-Western Pomerania   1.5165    0.9091   
overdisp.Saxony                          0.8423    0.2479   
overdisp.Saxony-Anhalt                   0.4366    0.2579   
overdisp.Thuringia                       2.0166    0.7019   

Epidemic dominant eigenvalue:  0.35 -- 1.48 

Penalized log-likelihood:  -6909.2 
Marginal log-likelihood:   -112 

Number of units:        16 
Number of time points:  363 

> 
> #############################
> ####### Model ZI4 ############
> #############################
> 
> f.end <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "none"),
+                            S = 2, period = 52)
> f.ar <- addSeason2formula(f = ~-1  +  ri(type = "iid", corr = "none"),
+                           S = 2, period = 52)
> f.zi <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "none"),
+                           S = 2, period = 52)
> 
> model.ZI4 <- list(ar = list(f = f.ar, offset =  Vac0 ),
+                   end = list(f = f.end, offset = population(measles) * Vac0 ),
+                   zi = list(f = f.zi),
+                   data = covarlist,
+                   family = "NegBinM",
+                   optimizer = control.optimizer)
> 
> result.ZI4 <- hhh4ZI(measles, model.ZI4)
> summary(result.ZI4, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4ZI(stsObj = measles, control = model.ZI4)

Random effects:
            Var    Corr   
ar.ri(iid)  0.0589        
end.ri(iid) 0.3389 0      
zi.ri(iid)  1.3467 0    0 

Fixed effects:
                                        Estimate  Std. Error
ar.A(2 * pi * t/52)                      0.1249    0.0575   
ar.s(2 * pi * t/52)                      1.2234    0.0392   
ar.A(4 * pi * t/52)                      0.4295    0.0524   
ar.s(4 * pi * t/52)                      0.0786    0.1216   
ar.ri(iid)                               1.3542    0.0830   
end.A(2 * pi * t/52)                     0.0588    0.0625   
end.s(2 * pi * t/52)                     1.3178    0.0453   
end.A(4 * pi * t/52)                     0.3728    0.0647   
end.s(4 * pi * t/52)                    -0.6244    0.0821   
end.ri(iid)                              4.5687    0.1637   
zi.A(2 * pi * t/52)                      0.2599    0.1345   
zi.s(2 * pi * t/52)                     -2.4021    0.0540   
zi.A(4 * pi * t/52)                      0.3204    0.1379   
zi.s(4 * pi * t/52)                      1.5514    0.0869   
zi.AR(1)                                -0.6624    0.1068   
zi.ri(iid)                              -0.3560    0.3280   
overdisp.Schleswig-Holstein              0.8653    0.2223   
overdisp.Hamburg                         0.4544    0.1656   
overdisp.Lower Saxony                    0.8251    0.1762   
overdisp.Bremen                          2.5414    1.5383   
overdisp.North Rhine-Westphalia          0.5063    0.0746   
overdisp.Hesse                           0.5746    0.1315   
overdisp.Rhineland-Palatinate            0.5079    0.1578   
overdisp.Baden-Wuerttemberg              0.5707    0.1011   
overdisp.Bavaria                         0.4418    0.0565   
overdisp.Saarland                        0.7175    0.6423   
overdisp.Berlin                          0.4896    0.0981   
overdisp.Brandenburg                     0.6611    0.2243   
overdisp.Mecklenburg-Western Pomerania   0.9137    0.6318   
overdisp.Saxony                          0.8555    0.2484   
overdisp.Saxony-Anhalt                   0.6422    0.3969   
overdisp.Thuringia                       2.4876    0.9226   

Epidemic dominant eigenvalue:  0.38 -- 1.51 

Penalized log-likelihood:  -6911.9 
Marginal log-likelihood:   -125.9 

Number of units:        16 
Number of time points:  363 

> 
> #############################
> ####### Model ZI5 ############
> #############################
> 
> f.end <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "all"),
+                            S = 2, period = 52)
> f.ar <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "all"),
+                           S = 2, period = 52)
> f.zi <- addSeason2formula(f = ~-1 +  ri(type = "iid", corr = "all"),
+                           S = 2, period = 52)
> 
> model.ZI5 <- list(ar = list(f = f.ar, offset =  Vac0 ),
+                   end = list(f = f.end, offset = population(measles) * Vac0 ),
+                   zi = list(f = f.zi),
+                   data = covarlist,
+                   family = "NegBinM",
+                   optimizer = control.optimizer,
+                   verbose = TRUE)
> 
> result.ZI5 <- hhh4ZI(measles, model.ZI5)
2023-04-24 16:12:06.605971 : Iterative optimization of regression & variance parameters 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 2.2411 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 1.2171 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.1564 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.24362 
Update of variance parameters in iteration  2  unreliable

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.067967 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.16528 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.029294 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.074362 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.012515 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.030711 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.0080612 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.015546 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.0072398 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.01078 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.0066952 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.007254 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.00454 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.0049638 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.002927 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.0030096 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.0019039 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.0020351 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.0014528 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.0013275 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.0008311 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.0012837 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.0004152 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.00066282 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.0002102 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.00052726 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.00035852 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.00042371 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 8.4528e-05 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.00019987 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0.00023538 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.00016309 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 8.3391e-05 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.00028415 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 8.5047e-05 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0.00020599 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 4.5302e-05 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0 

Update of regression parameters:  max|x_0 - x_1| / max|x_0| = 0 
Update of variance parameters:  max|x_0 - x_1| / max|x_0| = 0 

2023-04-24 16:12:14.701885 : Optimization converged 

> summary(result.ZI5, amplitudeShift = TRUE, maxEV = TRUE)

Call: 
hhh4ZI(stsObj = measles, control = model.ZI5)

Random effects:
            Var    Corr        
ar.ri(iid)  0.0778             
end.ri(iid) 0.4364 0.218       
zi.ri(iid)  1.8722 0.651 0.704 

Fixed effects:
                                        Estimate  Std. Error
ar.A(2 * pi * t/52)                      0.1218    0.0573   
ar.s(2 * pi * t/52)                      1.2607    0.0381   
ar.A(4 * pi * t/52)                      0.4332    0.0525   
ar.s(4 * pi * t/52)                      0.0692    0.1201   
ar.ri(iid)                               1.3888    0.0887   
end.A(2 * pi * t/52)                     0.0804    0.0612   
end.s(2 * pi * t/52)                     1.1904    0.0491   
end.A(4 * pi * t/52)                     0.3752    0.0630   
end.s(4 * pi * t/52)                    -0.6862    0.0758   
end.ri(iid)                              4.6171    0.1820   
zi.A(2 * pi * t/52)                      0.2101    0.1351   
zi.s(2 * pi * t/52)                     -2.4299    0.0517   
zi.A(4 * pi * t/52)                      0.2603    0.1362   
zi.s(4 * pi * t/52)                      1.6370    0.0829   
zi.AR(1)                                -0.7236    0.1144   
zi.ri(iid)                              -0.3681    0.3821   
overdisp.Schleswig-Holstein              0.9004    0.2173   
overdisp.Hamburg                         0.4418    0.1608   
overdisp.Lower Saxony                    0.9239    0.1884   
overdisp.Bremen                          3.0208    1.5213   
overdisp.North Rhine-Westphalia          0.5165    0.0752   
overdisp.Hesse                           0.6029    0.1374   
overdisp.Rhineland-Palatinate            0.5726    0.1612   
overdisp.Baden-Wuerttemberg              0.6054    0.1086   
overdisp.Bavaria                         0.4382    0.0555   
overdisp.Saarland                        0.3930    0.3998   
overdisp.Berlin                          0.4821    0.0949   
overdisp.Brandenburg                     0.6134    0.2060   
overdisp.Mecklenburg-Western Pomerania   0.9796    0.7354   
overdisp.Saxony                          0.8313    0.2416   
overdisp.Saxony-Anhalt                   0.4848    0.2927   
overdisp.Thuringia                       2.0148    0.7222   

Epidemic dominant eigenvalue:  0.35 -- 1.48 

Penalized log-likelihood:  -6908.6 
Marginal log-likelihood:   -121.5 

Number of units:        16 
Number of time points:  363 

> 
> 
> ###########################################################
> ## Exemplary summary of model ZI3
> ###########################################################
> plotHHH4ZI_season(result.ZI3, components = c("en", "ar"),
+                   period = 52, xlab = "biweek")
> plotHHH4ZI_maxEV(result.ZI3)
> plotHHH4ZI_fitted(units = 1:8,  result.ZI3, par.settings = list(mfrow=c(4,2)))
> plotHHH4ZI_fitted(units = 9:16, result.ZI3, par.settings = list(mfrow=c(4,2)))
> plotHHH4ZI_maps(result.ZI3, prop = TRUE,
+                 which = c("mean", "endemic", "epi.own", "zi"),
+                 main = c("fitted counts", "endemic proportion",
+                          "autoregressive proportion", "ZI probability"),
+                 par.settings = list(add.line = list(col = "white")))
> plotHHH4ZI_ri(result.ZI3, component = "ar.ri(iid)", main = "autoregressive", exp = TRUE)
> plotHHH4ZI_ri(result.ZI3, component = "end.ri(iid)", main = "endemic", exp = TRUE)
> plotHHH4ZI_ri(result.ZI3, component = "zi.ri(iid)", main = "zero inflation", exp = TRUE)
> 
> ######################################################################
> # Compare the predictive performance of the models by computing
> # one-step-ahead predictions to be assessed by proper scoring rules
> ######################################################################
> tp <- 261
> i <- 1
> type <- "rolling"
> model_names <- c("P0",
+                  "NB1", "NB2", "NB3",
+                  "ZI1", "ZI2", "ZI3", "ZI4", "ZI5")
> score_table <- data.frame()
> score_list <- list()
> 
> # forecast
> for (model_name in model_names){
+   modeli <- get(paste0("result.", model_name))
+   cat("\n--- forecasting with", model_name, "---\n")
+   osai <- oneStepAhead(modeli, tp = tp, type = type, which.start = "final")
+   score_list[[i]] <-
+     scorei <- scores(osai)
+   score_table <- rbind(score_table,
+                        c(colMeans(scorei), sapply(as.data.frame(scorei), max)))
+   i <- i + 1
+ }

--- forecasting with P0 ---
One-step-ahead prediction @ t = 261 ...
One-step-ahead prediction @ t = 262 ...
One-step-ahead prediction @ t = 263 ...
One-step-ahead prediction @ t = 264 ...
One-step-ahead prediction @ t = 265 ...
One-step-ahead prediction @ t = 266 ...
One-step-ahead prediction @ t = 267 ...
One-step-ahead prediction @ t = 268 ...
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
One-step-ahead prediction @ t = 271 ...
One-step-ahead prediction @ t = 272 ...
One-step-ahead prediction @ t = 273 ...
One-step-ahead prediction @ t = 274 ...
One-step-ahead prediction @ t = 275 ...
One-step-ahead prediction @ t = 276 ...
One-step-ahead prediction @ t = 277 ...
One-step-ahead prediction @ t = 278 ...
One-step-ahead prediction @ t = 279 ...
One-step-ahead prediction @ t = 280 ...
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
One-step-ahead prediction @ t = 283 ...
One-step-ahead prediction @ t = 284 ...
One-step-ahead prediction @ t = 285 ...
One-step-ahead prediction @ t = 286 ...
One-step-ahead prediction @ t = 287 ...
One-step-ahead prediction @ t = 288 ...
One-step-ahead prediction @ t = 289 ...
One-step-ahead prediction @ t = 290 ...
One-step-ahead prediction @ t = 291 ...
One-step-ahead prediction @ t = 292 ...
One-step-ahead prediction @ t = 293 ...
One-step-ahead prediction @ t = 294 ...
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
One-step-ahead prediction @ t = 299 ...
One-step-ahead prediction @ t = 300 ...
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
One-step-ahead prediction @ t = 305 ...
One-step-ahead prediction @ t = 306 ...
One-step-ahead prediction @ t = 307 ...
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
One-step-ahead prediction @ t = 312 ...
One-step-ahead prediction @ t = 313 ...
One-step-ahead prediction @ t = 314 ...
One-step-ahead prediction @ t = 315 ...
One-step-ahead prediction @ t = 316 ...
One-step-ahead prediction @ t = 317 ...
One-step-ahead prediction @ t = 318 ...
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
One-step-ahead prediction @ t = 321 ...
One-step-ahead prediction @ t = 322 ...
One-step-ahead prediction @ t = 323 ...
One-step-ahead prediction @ t = 324 ...
One-step-ahead prediction @ t = 325 ...
One-step-ahead prediction @ t = 326 ...
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
One-step-ahead prediction @ t = 335 ...
One-step-ahead prediction @ t = 336 ...
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
One-step-ahead prediction @ t = 340 ...
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
One-step-ahead prediction @ t = 343 ...
One-step-ahead prediction @ t = 344 ...
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
One-step-ahead prediction @ t = 347 ...
One-step-ahead prediction @ t = 348 ...
One-step-ahead prediction @ t = 349 ...
One-step-ahead prediction @ t = 350 ...
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
One-step-ahead prediction @ t = 353 ...
One-step-ahead prediction @ t = 354 ...
One-step-ahead prediction @ t = 355 ...
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...

--- forecasting with NB1 ---
One-step-ahead prediction @ t = 261 ...
One-step-ahead prediction @ t = 262 ...
One-step-ahead prediction @ t = 263 ...
One-step-ahead prediction @ t = 264 ...
One-step-ahead prediction @ t = 265 ...
One-step-ahead prediction @ t = 266 ...
One-step-ahead prediction @ t = 267 ...
One-step-ahead prediction @ t = 268 ...
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
One-step-ahead prediction @ t = 271 ...
One-step-ahead prediction @ t = 272 ...
One-step-ahead prediction @ t = 273 ...
One-step-ahead prediction @ t = 274 ...
One-step-ahead prediction @ t = 275 ...
One-step-ahead prediction @ t = 276 ...
One-step-ahead prediction @ t = 277 ...
One-step-ahead prediction @ t = 278 ...
One-step-ahead prediction @ t = 279 ...
One-step-ahead prediction @ t = 280 ...
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
One-step-ahead prediction @ t = 283 ...
One-step-ahead prediction @ t = 284 ...
One-step-ahead prediction @ t = 285 ...
One-step-ahead prediction @ t = 286 ...
One-step-ahead prediction @ t = 287 ...
One-step-ahead prediction @ t = 288 ...
One-step-ahead prediction @ t = 289 ...
One-step-ahead prediction @ t = 290 ...
One-step-ahead prediction @ t = 291 ...
One-step-ahead prediction @ t = 292 ...
One-step-ahead prediction @ t = 293 ...
One-step-ahead prediction @ t = 294 ...
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
One-step-ahead prediction @ t = 299 ...
One-step-ahead prediction @ t = 300 ...
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
One-step-ahead prediction @ t = 305 ...
One-step-ahead prediction @ t = 306 ...
One-step-ahead prediction @ t = 307 ...
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
One-step-ahead prediction @ t = 312 ...
One-step-ahead prediction @ t = 313 ...
One-step-ahead prediction @ t = 314 ...
One-step-ahead prediction @ t = 315 ...
One-step-ahead prediction @ t = 316 ...
One-step-ahead prediction @ t = 317 ...
One-step-ahead prediction @ t = 318 ...
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
One-step-ahead prediction @ t = 321 ...
One-step-ahead prediction @ t = 322 ...
One-step-ahead prediction @ t = 323 ...
One-step-ahead prediction @ t = 324 ...
One-step-ahead prediction @ t = 325 ...
One-step-ahead prediction @ t = 326 ...
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
One-step-ahead prediction @ t = 335 ...
One-step-ahead prediction @ t = 336 ...
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
One-step-ahead prediction @ t = 340 ...
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
One-step-ahead prediction @ t = 343 ...
One-step-ahead prediction @ t = 344 ...
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
One-step-ahead prediction @ t = 347 ...
One-step-ahead prediction @ t = 348 ...
One-step-ahead prediction @ t = 349 ...
One-step-ahead prediction @ t = 350 ...
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
One-step-ahead prediction @ t = 353 ...
One-step-ahead prediction @ t = 354 ...
One-step-ahead prediction @ t = 355 ...
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...

--- forecasting with NB2 ---
One-step-ahead prediction @ t = 261 ...
One-step-ahead prediction @ t = 262 ...
One-step-ahead prediction @ t = 263 ...
One-step-ahead prediction @ t = 264 ...
One-step-ahead prediction @ t = 265 ...
One-step-ahead prediction @ t = 266 ...
One-step-ahead prediction @ t = 267 ...
One-step-ahead prediction @ t = 268 ...
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
One-step-ahead prediction @ t = 271 ...
One-step-ahead prediction @ t = 272 ...
One-step-ahead prediction @ t = 273 ...
One-step-ahead prediction @ t = 274 ...
One-step-ahead prediction @ t = 275 ...
One-step-ahead prediction @ t = 276 ...
One-step-ahead prediction @ t = 277 ...
One-step-ahead prediction @ t = 278 ...
One-step-ahead prediction @ t = 279 ...
One-step-ahead prediction @ t = 280 ...
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
One-step-ahead prediction @ t = 283 ...
One-step-ahead prediction @ t = 284 ...
One-step-ahead prediction @ t = 285 ...
One-step-ahead prediction @ t = 286 ...
One-step-ahead prediction @ t = 287 ...
One-step-ahead prediction @ t = 288 ...
One-step-ahead prediction @ t = 289 ...
One-step-ahead prediction @ t = 290 ...
One-step-ahead prediction @ t = 291 ...
One-step-ahead prediction @ t = 292 ...
One-step-ahead prediction @ t = 293 ...
One-step-ahead prediction @ t = 294 ...
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
One-step-ahead prediction @ t = 299 ...
One-step-ahead prediction @ t = 300 ...
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
One-step-ahead prediction @ t = 305 ...
One-step-ahead prediction @ t = 306 ...
One-step-ahead prediction @ t = 307 ...
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
One-step-ahead prediction @ t = 312 ...
One-step-ahead prediction @ t = 313 ...
One-step-ahead prediction @ t = 314 ...
One-step-ahead prediction @ t = 315 ...
One-step-ahead prediction @ t = 316 ...
One-step-ahead prediction @ t = 317 ...
One-step-ahead prediction @ t = 318 ...
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
One-step-ahead prediction @ t = 321 ...
One-step-ahead prediction @ t = 322 ...
One-step-ahead prediction @ t = 323 ...
One-step-ahead prediction @ t = 324 ...
One-step-ahead prediction @ t = 325 ...
One-step-ahead prediction @ t = 326 ...
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
One-step-ahead prediction @ t = 335 ...
One-step-ahead prediction @ t = 336 ...
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
One-step-ahead prediction @ t = 340 ...
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
One-step-ahead prediction @ t = 343 ...
One-step-ahead prediction @ t = 344 ...
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
One-step-ahead prediction @ t = 347 ...
One-step-ahead prediction @ t = 348 ...
One-step-ahead prediction @ t = 349 ...
One-step-ahead prediction @ t = 350 ...
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
One-step-ahead prediction @ t = 353 ...
One-step-ahead prediction @ t = 354 ...
One-step-ahead prediction @ t = 355 ...
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...

--- forecasting with NB3 ---
One-step-ahead prediction @ t = 261 ...
One-step-ahead prediction @ t = 262 ...
One-step-ahead prediction @ t = 263 ...
One-step-ahead prediction @ t = 264 ...
One-step-ahead prediction @ t = 265 ...
One-step-ahead prediction @ t = 266 ...
One-step-ahead prediction @ t = 267 ...
One-step-ahead prediction @ t = 268 ...
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
One-step-ahead prediction @ t = 271 ...
One-step-ahead prediction @ t = 272 ...
One-step-ahead prediction @ t = 273 ...
One-step-ahead prediction @ t = 274 ...
One-step-ahead prediction @ t = 275 ...
One-step-ahead prediction @ t = 276 ...
One-step-ahead prediction @ t = 277 ...
One-step-ahead prediction @ t = 278 ...
One-step-ahead prediction @ t = 279 ...
One-step-ahead prediction @ t = 280 ...
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
One-step-ahead prediction @ t = 283 ...
One-step-ahead prediction @ t = 284 ...
One-step-ahead prediction @ t = 285 ...
One-step-ahead prediction @ t = 286 ...
One-step-ahead prediction @ t = 287 ...
One-step-ahead prediction @ t = 288 ...
One-step-ahead prediction @ t = 289 ...
One-step-ahead prediction @ t = 290 ...
One-step-ahead prediction @ t = 291 ...
One-step-ahead prediction @ t = 292 ...
One-step-ahead prediction @ t = 293 ...
One-step-ahead prediction @ t = 294 ...
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
One-step-ahead prediction @ t = 299 ...
One-step-ahead prediction @ t = 300 ...
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
One-step-ahead prediction @ t = 305 ...
One-step-ahead prediction @ t = 306 ...
One-step-ahead prediction @ t = 307 ...
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
One-step-ahead prediction @ t = 312 ...
One-step-ahead prediction @ t = 313 ...
One-step-ahead prediction @ t = 314 ...
One-step-ahead prediction @ t = 315 ...
One-step-ahead prediction @ t = 316 ...
One-step-ahead prediction @ t = 317 ...
One-step-ahead prediction @ t = 318 ...
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
One-step-ahead prediction @ t = 321 ...
One-step-ahead prediction @ t = 322 ...
One-step-ahead prediction @ t = 323 ...
One-step-ahead prediction @ t = 324 ...
One-step-ahead prediction @ t = 325 ...
One-step-ahead prediction @ t = 326 ...
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
One-step-ahead prediction @ t = 335 ...
One-step-ahead prediction @ t = 336 ...
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
One-step-ahead prediction @ t = 340 ...
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
One-step-ahead prediction @ t = 343 ...
One-step-ahead prediction @ t = 344 ...
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
One-step-ahead prediction @ t = 347 ...
One-step-ahead prediction @ t = 348 ...
One-step-ahead prediction @ t = 349 ...
One-step-ahead prediction @ t = 350 ...
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
One-step-ahead prediction @ t = 353 ...
One-step-ahead prediction @ t = 354 ...
One-step-ahead prediction @ t = 355 ...
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...

--- forecasting with ZI1 ---
One-step-ahead prediction @ t = 261 ...
One-step-ahead prediction @ t = 262 ...
One-step-ahead prediction @ t = 263 ...
One-step-ahead prediction @ t = 264 ...
One-step-ahead prediction @ t = 265 ...
One-step-ahead prediction @ t = 266 ...
One-step-ahead prediction @ t = 267 ...
One-step-ahead prediction @ t = 268 ...
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
One-step-ahead prediction @ t = 271 ...
One-step-ahead prediction @ t = 272 ...
One-step-ahead prediction @ t = 273 ...
One-step-ahead prediction @ t = 274 ...
One-step-ahead prediction @ t = 275 ...
One-step-ahead prediction @ t = 276 ...
One-step-ahead prediction @ t = 277 ...
One-step-ahead prediction @ t = 278 ...
One-step-ahead prediction @ t = 279 ...
One-step-ahead prediction @ t = 280 ...
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
One-step-ahead prediction @ t = 283 ...
One-step-ahead prediction @ t = 284 ...
One-step-ahead prediction @ t = 285 ...
One-step-ahead prediction @ t = 286 ...
One-step-ahead prediction @ t = 287 ...
One-step-ahead prediction @ t = 288 ...
One-step-ahead prediction @ t = 289 ...
One-step-ahead prediction @ t = 290 ...
One-step-ahead prediction @ t = 291 ...
One-step-ahead prediction @ t = 292 ...
One-step-ahead prediction @ t = 293 ...
One-step-ahead prediction @ t = 294 ...
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
One-step-ahead prediction @ t = 299 ...
One-step-ahead prediction @ t = 300 ...
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
One-step-ahead prediction @ t = 305 ...
One-step-ahead prediction @ t = 306 ...
One-step-ahead prediction @ t = 307 ...
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
One-step-ahead prediction @ t = 312 ...
One-step-ahead prediction @ t = 313 ...
One-step-ahead prediction @ t = 314 ...
One-step-ahead prediction @ t = 315 ...
One-step-ahead prediction @ t = 316 ...
One-step-ahead prediction @ t = 317 ...
One-step-ahead prediction @ t = 318 ...
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
One-step-ahead prediction @ t = 321 ...
One-step-ahead prediction @ t = 322 ...
One-step-ahead prediction @ t = 323 ...
One-step-ahead prediction @ t = 324 ...
One-step-ahead prediction @ t = 325 ...
One-step-ahead prediction @ t = 326 ...
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
One-step-ahead prediction @ t = 335 ...
One-step-ahead prediction @ t = 336 ...
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
One-step-ahead prediction @ t = 340 ...
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
One-step-ahead prediction @ t = 343 ...
One-step-ahead prediction @ t = 344 ...
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
One-step-ahead prediction @ t = 347 ...
One-step-ahead prediction @ t = 348 ...
One-step-ahead prediction @ t = 349 ...
One-step-ahead prediction @ t = 350 ...
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
One-step-ahead prediction @ t = 353 ...
One-step-ahead prediction @ t = 354 ...
One-step-ahead prediction @ t = 355 ...
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...

--- forecasting with ZI2 ---
One-step-ahead prediction @ t = 261 ...
One-step-ahead prediction @ t = 262 ...
One-step-ahead prediction @ t = 263 ...
One-step-ahead prediction @ t = 264 ...
One-step-ahead prediction @ t = 265 ...
One-step-ahead prediction @ t = 266 ...
One-step-ahead prediction @ t = 267 ...
One-step-ahead prediction @ t = 268 ...
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
One-step-ahead prediction @ t = 271 ...
One-step-ahead prediction @ t = 272 ...
One-step-ahead prediction @ t = 273 ...
One-step-ahead prediction @ t = 274 ...
One-step-ahead prediction @ t = 275 ...
One-step-ahead prediction @ t = 276 ...
One-step-ahead prediction @ t = 277 ...
One-step-ahead prediction @ t = 278 ...
One-step-ahead prediction @ t = 279 ...
One-step-ahead prediction @ t = 280 ...
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
One-step-ahead prediction @ t = 283 ...
One-step-ahead prediction @ t = 284 ...
One-step-ahead prediction @ t = 285 ...
One-step-ahead prediction @ t = 286 ...
One-step-ahead prediction @ t = 287 ...
One-step-ahead prediction @ t = 288 ...
One-step-ahead prediction @ t = 289 ...
One-step-ahead prediction @ t = 290 ...
One-step-ahead prediction @ t = 291 ...
One-step-ahead prediction @ t = 292 ...
One-step-ahead prediction @ t = 293 ...
One-step-ahead prediction @ t = 294 ...
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
One-step-ahead prediction @ t = 299 ...
One-step-ahead prediction @ t = 300 ...
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
One-step-ahead prediction @ t = 305 ...
One-step-ahead prediction @ t = 306 ...
One-step-ahead prediction @ t = 307 ...
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
One-step-ahead prediction @ t = 312 ...
One-step-ahead prediction @ t = 313 ...
One-step-ahead prediction @ t = 314 ...
One-step-ahead prediction @ t = 315 ...
One-step-ahead prediction @ t = 316 ...
One-step-ahead prediction @ t = 317 ...
One-step-ahead prediction @ t = 318 ...
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
One-step-ahead prediction @ t = 321 ...
One-step-ahead prediction @ t = 322 ...
One-step-ahead prediction @ t = 323 ...
One-step-ahead prediction @ t = 324 ...
One-step-ahead prediction @ t = 325 ...
One-step-ahead prediction @ t = 326 ...
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
One-step-ahead prediction @ t = 335 ...
One-step-ahead prediction @ t = 336 ...
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
One-step-ahead prediction @ t = 340 ...
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
One-step-ahead prediction @ t = 343 ...
One-step-ahead prediction @ t = 344 ...
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
One-step-ahead prediction @ t = 347 ...
One-step-ahead prediction @ t = 348 ...
One-step-ahead prediction @ t = 349 ...
One-step-ahead prediction @ t = 350 ...
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
One-step-ahead prediction @ t = 353 ...
One-step-ahead prediction @ t = 354 ...
One-step-ahead prediction @ t = 355 ...
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...

--- forecasting with ZI3 ---
One-step-ahead prediction @ t = 261 ...
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 262 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 263 ...
Update of variance parameters in iteration  2  unreliable
Update of variance parameters in iteration  15  unreliable
Update of variance parameters in iteration  30  unreliable
Update of variance parameters in iteration  31  unreliable
Update of variance parameters in iteration  32  unreliable
Update of variance parameters in iteration  44  unreliable
Update of variance parameters in iteration  58  unreliable
Update of variance parameters in iteration  72  unreliable
Update of variance parameters in iteration  86  unreliable
Update of variance parameters in iteration  89  unreliable
Update of variance parameters in iteration  101  unreliable
Update of variance parameters in iteration  115  unreliable
Update of variance parameters in iteration  129  unreliable
Update of variance parameters in iteration  144  unreliable
Update of variance parameters in iteration  158  unreliable
Update of variance parameters in iteration  160  unreliable
Update of variance parameters in iteration  173  unreliable
Update of variance parameters in iteration  174  unreliable
Update of variance parameters in iteration  176  unreliable
Update of variance parameters in iteration  188  unreliable
Update of variance parameters in iteration  189  unreliable
WARNING: No convergence @ t = 263 !
WARNING: Last fit is used
One-step-ahead prediction @ t = 264 ...
Update of variance parameters in iteration  32  unreliable
Update of variance parameters in iteration  33  unreliable
Update of variance parameters in iteration  67  unreliable
Update of variance parameters in iteration  69  unreliable
Update of variance parameters in iteration  102  unreliable
Update of variance parameters in iteration  137  unreliable
Update of variance parameters in iteration  139  unreliable
Update of variance parameters in iteration  174  unreliable
WARNING: No convergence @ t = 264 !
WARNING: Last fit is used
One-step-ahead prediction @ t = 265 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 266 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 267 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 268 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 271 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 272 ...
Update of variance parameters in iteration  7  unreliable
One-step-ahead prediction @ t = 273 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 274 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 275 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 276 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 277 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 278 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 279 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 280 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
One-step-ahead prediction @ t = 283 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 284 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 285 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 286 ...
Update of variance parameters in iteration  6  unreliable
One-step-ahead prediction @ t = 287 ...
One-step-ahead prediction @ t = 288 ...
One-step-ahead prediction @ t = 289 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 290 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 291 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 292 ...
One-step-ahead prediction @ t = 293 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 294 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  7  unreliable
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
One-step-ahead prediction @ t = 299 ...
One-step-ahead prediction @ t = 300 ...
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
One-step-ahead prediction @ t = 305 ...
One-step-ahead prediction @ t = 306 ...
One-step-ahead prediction @ t = 307 ...
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
One-step-ahead prediction @ t = 312 ...
One-step-ahead prediction @ t = 313 ...
One-step-ahead prediction @ t = 314 ...
One-step-ahead prediction @ t = 315 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 316 ...
Update of variance parameters in iteration  4  unreliable
Update of variance parameters in iteration  7  unreliable
One-step-ahead prediction @ t = 317 ...
One-step-ahead prediction @ t = 318 ...
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 321 ...
One-step-ahead prediction @ t = 322 ...
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 323 ...
One-step-ahead prediction @ t = 324 ...
One-step-ahead prediction @ t = 325 ...
One-step-ahead prediction @ t = 326 ...
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 335 ...
One-step-ahead prediction @ t = 336 ...
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
One-step-ahead prediction @ t = 340 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
One-step-ahead prediction @ t = 343 ...
One-step-ahead prediction @ t = 344 ...
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
One-step-ahead prediction @ t = 347 ...
One-step-ahead prediction @ t = 348 ...
One-step-ahead prediction @ t = 349 ...
One-step-ahead prediction @ t = 350 ...
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
One-step-ahead prediction @ t = 353 ...
One-step-ahead prediction @ t = 354 ...
One-step-ahead prediction @ t = 355 ...
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...

--- forecasting with ZI4 ---
One-step-ahead prediction @ t = 261 ...
One-step-ahead prediction @ t = 262 ...
One-step-ahead prediction @ t = 263 ...
One-step-ahead prediction @ t = 264 ...
One-step-ahead prediction @ t = 265 ...
One-step-ahead prediction @ t = 266 ...
One-step-ahead prediction @ t = 267 ...
One-step-ahead prediction @ t = 268 ...
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
One-step-ahead prediction @ t = 271 ...
One-step-ahead prediction @ t = 272 ...
One-step-ahead prediction @ t = 273 ...
One-step-ahead prediction @ t = 274 ...
One-step-ahead prediction @ t = 275 ...
One-step-ahead prediction @ t = 276 ...
One-step-ahead prediction @ t = 277 ...
One-step-ahead prediction @ t = 278 ...
One-step-ahead prediction @ t = 279 ...
One-step-ahead prediction @ t = 280 ...
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
One-step-ahead prediction @ t = 283 ...
One-step-ahead prediction @ t = 284 ...
One-step-ahead prediction @ t = 285 ...
One-step-ahead prediction @ t = 286 ...
One-step-ahead prediction @ t = 287 ...
One-step-ahead prediction @ t = 288 ...
One-step-ahead prediction @ t = 289 ...
One-step-ahead prediction @ t = 290 ...
One-step-ahead prediction @ t = 291 ...
One-step-ahead prediction @ t = 292 ...
One-step-ahead prediction @ t = 293 ...
One-step-ahead prediction @ t = 294 ...
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
One-step-ahead prediction @ t = 299 ...
One-step-ahead prediction @ t = 300 ...
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
One-step-ahead prediction @ t = 305 ...
One-step-ahead prediction @ t = 306 ...
One-step-ahead prediction @ t = 307 ...
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
One-step-ahead prediction @ t = 312 ...
One-step-ahead prediction @ t = 313 ...
One-step-ahead prediction @ t = 314 ...
One-step-ahead prediction @ t = 315 ...
One-step-ahead prediction @ t = 316 ...
One-step-ahead prediction @ t = 317 ...
One-step-ahead prediction @ t = 318 ...
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
One-step-ahead prediction @ t = 321 ...
One-step-ahead prediction @ t = 322 ...
One-step-ahead prediction @ t = 323 ...
One-step-ahead prediction @ t = 324 ...
One-step-ahead prediction @ t = 325 ...
One-step-ahead prediction @ t = 326 ...
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
One-step-ahead prediction @ t = 335 ...
One-step-ahead prediction @ t = 336 ...
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
One-step-ahead prediction @ t = 340 ...
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
One-step-ahead prediction @ t = 343 ...
One-step-ahead prediction @ t = 344 ...
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
One-step-ahead prediction @ t = 347 ...
One-step-ahead prediction @ t = 348 ...
One-step-ahead prediction @ t = 349 ...
One-step-ahead prediction @ t = 350 ...
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
One-step-ahead prediction @ t = 353 ...
One-step-ahead prediction @ t = 354 ...
One-step-ahead prediction @ t = 355 ...
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...

--- forecasting with ZI5 ---
One-step-ahead prediction @ t = 261 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 262 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 263 ...
One-step-ahead prediction @ t = 264 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 265 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 266 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 267 ...
One-step-ahead prediction @ t = 268 ...
Update of variance parameters in iteration  5  unreliable
Update of variance parameters in iteration  6  unreliable
Update of variance parameters in iteration  8  unreliable
Update of variance parameters in iteration  9  unreliable
One-step-ahead prediction @ t = 269 ...
One-step-ahead prediction @ t = 270 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 271 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 272 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 273 ...
One-step-ahead prediction @ t = 274 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 275 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 276 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 277 ...
One-step-ahead prediction @ t = 278 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 279 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 280 ...
One-step-ahead prediction @ t = 281 ...
One-step-ahead prediction @ t = 282 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 283 ...
One-step-ahead prediction @ t = 284 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 285 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 286 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 287 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 288 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 289 ...
One-step-ahead prediction @ t = 290 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 291 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 292 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 293 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 294 ...
One-step-ahead prediction @ t = 295 ...
One-step-ahead prediction @ t = 296 ...
One-step-ahead prediction @ t = 297 ...
One-step-ahead prediction @ t = 298 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 299 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 300 ...
One-step-ahead prediction @ t = 301 ...
One-step-ahead prediction @ t = 302 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 303 ...
One-step-ahead prediction @ t = 304 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 305 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 306 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 307 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 308 ...
One-step-ahead prediction @ t = 309 ...
One-step-ahead prediction @ t = 310 ...
One-step-ahead prediction @ t = 311 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 312 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 313 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 314 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 315 ...
One-step-ahead prediction @ t = 316 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 317 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 318 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 319 ...
One-step-ahead prediction @ t = 320 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 321 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 322 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 323 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 324 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 325 ...
Update of variance parameters in iteration  1  unreliable
Update of variance parameters in iteration  2  unreliable
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 326 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 327 ...
One-step-ahead prediction @ t = 328 ...
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 329 ...
One-step-ahead prediction @ t = 330 ...
Update of variance parameters in iteration  2  unreliable
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 331 ...
One-step-ahead prediction @ t = 332 ...
One-step-ahead prediction @ t = 333 ...
One-step-ahead prediction @ t = 334 ...
One-step-ahead prediction @ t = 335 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 336 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 337 ...
One-step-ahead prediction @ t = 338 ...
One-step-ahead prediction @ t = 339 ...
Update of variance parameters in iteration  2  unreliable
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 340 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 341 ...
One-step-ahead prediction @ t = 342 ...
Update of variance parameters in iteration  2  unreliable
One-step-ahead prediction @ t = 343 ...
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 344 ...
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 345 ...
One-step-ahead prediction @ t = 346 ...
Update of variance parameters in iteration  3  unreliable
Update of variance parameters in iteration  5  unreliable
One-step-ahead prediction @ t = 347 ...
Update of variance parameters in iteration  3  unreliable
One-step-ahead prediction @ t = 348 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 349 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 350 ...
Update of variance parameters in iteration  1  unreliable
One-step-ahead prediction @ t = 351 ...
One-step-ahead prediction @ t = 352 ...
Update of variance parameters in iteration  4  unreliable
One-step-ahead prediction @ t = 353 ...
Update of variance parameters in iteration  2  unreliable
Update of variance parameters in iteration  4  unreliable
One-step-ahead prediction @ t = 354 ...
Update of variance parameters in iteration  4  unreliable
One-step-ahead prediction @ t = 355 ...
Update of variance parameters in iteration  4  unreliable
One-step-ahead prediction @ t = 356 ...
One-step-ahead prediction @ t = 357 ...
Update of variance parameters in iteration  4  unreliable
Update of variance parameters in iteration  5  unreliable
One-step-ahead prediction @ t = 358 ...
One-step-ahead prediction @ t = 359 ...
One-step-ahead prediction @ t = 360 ...
One-step-ahead prediction @ t = 361 ...
One-step-ahead prediction @ t = 362 ...
One-step-ahead prediction @ t = 363 ...
Warning messages:
1: In hhh4ZI(object$stsObj, control) : Results are not reliable!
  Try different starting values, more iterations, or another optimizer.

2: In hhh4ZI(object$stsObj, control) : Results are not reliable!
  Try different starting values, more iterations, or another optimizer.

> 
> ref_score <- score_list[[7]][,1]
> Test_score <- sapply(score_list, FUN = function(x){
+   permutationTest(x[,1], ref_score, nPermutation = 9999)$pVal.permut
+ })
> Test_score[7] <- NA
> colnames(score_table) <- c(colnames(scorei)[1:4], colnames(scorei)[1:4])
> 
> printformat <- function(x) {
+   paste0(formatC(round(x, digits = 2), format='f', digits=2 ), " (",rank(x), ")")
+ }
> printformat2 <- function(x) {
+   round(x, digits = 2)
+ }
> 
> score_table2 <- data.frame(model_names, printformat(score_table[,1]),
+                            sapply(Test_score, printformat2),
+                            printformat(score_table[,5]),
+                            printformat(score_table[,3]),
+                            printformat(score_table[,2]),
+                            printformat(score_table[,4]))
> colnames(score_table2) <- c("Model", "LS", "p-value","maxLS", "DSS","RPS", "SES")
> print(score_table2)
  Model       LS p-value    maxLS      DSS      RPS       SES
1    P0 1.71 (9)    0.00 8.51 (9) 3.24 (9) 1.20 (8) 17.71 (7)
2   NB1 1.36 (8)    0.00 3.85 (1) 1.88 (6) 1.22 (9) 15.89 (3)
3   NB2 1.35 (5)    0.01 4.07 (8) 1.94 (8) 1.19 (6) 16.23 (4)
4   NB3 1.35 (6)    0.01 4.06 (7) 1.94 (7) 1.19 (7) 15.86 (2)
5   ZI1 1.36 (7)    0.00 3.86 (2) 1.85 (3) 1.18 (5) 15.47 (1)
6   ZI2 1.34 (3)    0.02 4.05 (6) 1.87 (5) 1.13 (3) 17.66 (6)
7   ZI3 1.33 (1)      NA 4.04 (5) 1.82 (1) 1.13 (1) 17.21 (5)
8   ZI4 1.34 (4)    0.03 3.96 (3) 1.86 (4) 1.14 (4) 18.05 (8)
9   ZI5 1.34 (2)    0.06 3.97 (4) 1.82 (2) 1.13 (2) 18.08 (9)
> 
> cat("Time elapsed: ", proc.time() - ptm, "\n")
Time elapsed:  2579.7 1.479 2581.3 0 0 
> 
